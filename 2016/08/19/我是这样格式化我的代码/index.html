<!DOCTYPE html><html lang="en-us"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><title>我是这样格式化我的代码 | ProgramerSunny</title><meta name="description"><meta name="generator" content="ProgramerSunny"><meta name="author" content="Programer Sunny"><meta name="keywords" content="一名iOS开发者,对动态化和组件化两个词语比较感兴趣，正在学习中。"><meta name="HandheldFriendly" content="True"><meta name="MobileOptimized" content="320"><meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1,user-scalable=0"><link rel="stylesheet" type="text/css" href="/styles/screen.css"><link rel="apple-touch-icon" sizes="57x57" href="/images/apple-touch-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/images/apple-touch-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/images/apple-touch-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/images/apple-touch-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/images/apple-touch-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/images/apple-touch-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/images/apple-touch-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/images/apple-touch-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-180x180.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/images/favicon-96x96.png"><link rel="icon" type="image/png" sizes="160x160" href="/images/favicon-160x160.png"><link rel="icon" type="image/png" sizes="192x192" href="/images/favicon-192x192.png"><meta name="msapplication-TileColor" content="#121315"><meta name="msapplication-TileImage" content="/images/mstile-144x144.png"></head><body itemscope itemtype="https://schema.org/WebPage"><header itemscope itemtype="https://schema.org/WPHeader"><a href="/"><img src="/images/svdb.png" alt="ProgramerSunny" title="ProgramerSunny"></a><h1><a href="/" alt="ProgramerSunny" title="ProgramerSunny" itemprop="headline">ProgramerSunny</a></h1><p itemprop="description">一名iOS开发者,对动态化和组件化两个词语比较感兴趣，正在学习中。</p><nav itemscope itemtype="https://schema.org/SiteNavigationElement"><ul><li itemprop="name"><a href="/" alt="Home" title="Home" itemprop="url">Home</a></li><li itemprop="name"><a href="/articles" alt="Articles" title="Articles" itemprop="url">Articles</a></li><li itemprop="name"><a href="/about" alt="About" title="About" itemprop="url">About</a></li></ul></nav><div class="space"></div></header><main itemscope itemtype="https://schema.org/Blog"><article class="full"><h1 itemprop="headline">我是这样格式化我的代码</h1><span class="post-meta">Published on<time itemprop="datePublished" datetime="2016-08-19T07:55:13.000Z"> Friday, August 19th 2016 at 15:55</time><br>Last updated on<time itemprop="dateModified" datetime="2016-08-19T07:55:13.000Z"> Sunday, August 21st 2016 at 12:51</time></span><p>这篇文章是我整理的一份代码格式化的东西, 和一份我正在用的clang-format的配置文件。</p>
<a id="more"></a>
<h3 id="一、前面的话"><a href="#一、前面的话" class="headerlink" title="一、前面的话"></a>一、前面的话</h3><p>前段时间整理一系列公司的文档,写到代码编写规范和CodeReview规范中都提到代码格式化的问题。很多人都说能都自动化的步骤都应该通过自动化来解决,所以这个时候想到了以前一直舍不得用的clang-format。想起来还是有点惭愧，自从看了sunnyxx的《招聘一个靠谱的iOS》之后就仿佛也有了代码洁癖，但是一直也没有去整理自己的代码编写规范这些东西。后来看到了google的规范文档,感觉越来越想弄一下这个东西。</p>
<p><img src="http://i2.buimg.com/567571/33caa8485b3664b5.png" alt=""></p>
<h3 id="二、clang-format"><a href="#二、clang-format" class="headerlink" title="二、clang-format"></a>二、clang-format</h3><p><a href="https://github.com/travisjeffery/ClangFormat-Xcode"><em>clang-format</em></a><br>是一款Xcode的一个非常好用的插件。具体安装可以去GitHub查看官方的readme。</p>
<h3 id="三、-install-clang-format"><a href="#三、-install-clang-format" class="headerlink" title="三、 install clang-format"></a>三、 install clang-format</h3><p>官方的readme是英文的,由于我用上它和写这篇文章已经有一段时间了，我就简单的看着官方文档整理一下步骤吧！<br><a href="https://github.com/travisjeffery/ClangFormat-Xcode"><em>原文地址</em></a></p>
<ol>
<li>下载或者克隆这个文件<br><img src="http://i4.buimg.com/567571/f6fde5feb67252db.png" alt=""></li>
<li>像运行普通项目一样运行一下</li>
<li>cmd + q 完全退出一下Xcode</li>
<li>重新打开你的项目,应该会让你选择是否load这个插件。不要选skip。</li>
<li>没有第五,你已经装上这个插件了</li>
</ol>
<h3 id="四、How-to-init"><a href="#四、How-to-init" class="headerlink" title="四、How to init"></a>四、How to init</h3><p>在工程目录或者workspace目录下创建一个<code>.clang-format</code>文件<br><img src="http://i4.buimg.com/567571/1da53f4cd1bc9633.png" alt=""><br><img src="http://i4.buimg.com/567571/b5f72a18bea10286.png" alt=""><br><img src="http://i4.buimg.com/567571/20151db030f769c4.png" alt=""><br><img src="http://i4.buimg.com/567571/1214171b519c680c.png" alt=""></p>
<p>完成之后你会发现这个文件在你工程文件中是没有的。如果你在桌面上将任意文件改成.clang-format之后就会出现这个。<br><img src="http://i1.buimg.com/567571/12c3424371497a27.png" alt=""><br>其实还好，只需要打开终端</p>
<p>显示隐藏文件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">defaults write com.apple.finder AppleShowAllFiles -bool true &amp;&amp; killall Finder</div></pre></td></tr></table></figure></p>
<p>不显示隐藏文件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">defaults write com.apple.finder AppleShowAllFiles -bool false &amp;&amp; killall Finder</div></pre></td></tr></table></figure></p>
<p>通过两句命令就可以打开了。这个时候你可以通过vim打开并且编辑,或者在刚刚在Xcode中创建的时候编辑,不过我通常都是通过sublime来编辑这些东西的。</p>
<p>这个只是一个配置文件,这个文件是可以随意拖动的。</p>
<p>由于公司目前的规范是我写的,所以我也直接把这个文件放在了根目录中</p>
<ol>
<li>打开Finder</li>
<li>cmd＋shift＋g<br><img src="http://i1.buimg.com/567571/65f27507e6dc1145.png" alt=""></li>
<li>前往,前题是你刚过显示了隐藏文件,不然你看到的是很boring的内容</li>
<li>找到<code>.clang-format</code>文件,右键,，选择sublime text<br><img src="http://i4.buimg.com/567571/f2de4faccb5c7098.jpg" alt=""></li>
</ol>
<h3 id="五、How-to-config"><a href="#五、How-to-config" class="headerlink" title="五、How to config"></a>五、How to config</h3><p>这个就简单了,也没什么好说的,我的大概就是这个样子。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div></pre></td><td class="code"><pre><div class="line"># Custom options in the special build of clang-format (these are not standard options)</div><div class="line"># IndentNestedBlocks: false</div><div class="line"># AllowNewlineBeforeBlockParameter: false</div><div class="line">Language:        Cpp</div><div class="line"># BasedOnStyle:  Google</div><div class="line">AccessModifierOffset: -1</div><div class="line">ConstructorInitializerIndentWidth: 4</div><div class="line">SortIncludes: false</div><div class="line"></div><div class="line">AlignConsecutiveAssignments: true</div><div class="line">AlignAfterOpenBracket: true</div><div class="line">AlignEscapedNewlinesLeft: true</div><div class="line">AlignOperands: false</div><div class="line">AlignTrailingComments: true</div><div class="line"></div><div class="line">AllowAllParametersOfDeclarationOnNextLine: false</div><div class="line">AllowShortBlocksOnASingleLine: false</div><div class="line">AllowShortCaseLabelsOnASingleLine: false</div><div class="line">AllowShortFunctionsOnASingleLine: true</div><div class="line">AllowShortIfStatementsOnASingleLine: true</div><div class="line">AllowShortFunctionsOnASingleLine: All</div><div class="line">AllowShortLoopsOnASingleLine: true</div><div class="line"></div><div class="line">AlwaysBreakAfterDefinitionReturnType: false</div><div class="line">AlwaysBreakTemplateDeclarations: false</div><div class="line">AlwaysBreakBeforeMultilineStrings: false</div><div class="line"></div><div class="line">BreakBeforeBinaryOperators: None</div><div class="line">BreakBeforeTernaryOperators: false</div><div class="line">BreakConstructorInitializersBeforeComma: false</div><div class="line"></div><div class="line">BinPackArguments: true</div><div class="line">BinPackParameters: true</div><div class="line">ColumnLimit: 0</div><div class="line">ConstructorInitializerAllOnOneLineOrOnePerLine: true</div><div class="line">DerivePointerAlignment: false</div><div class="line">ExperimentalAutoDetectBinPacking: false</div><div class="line">IndentCaseLabels: true</div><div class="line">IndentWrappedFunctionNames: false</div><div class="line">IndentFunctionDeclarationAfterType: false</div><div class="line">MaxEmptyLinesToKeep: 2</div><div class="line">KeepEmptyLinesAtTheStartOfBlocks: false</div><div class="line">NamespaceIndentation: Inner</div><div class="line">ObjCBlockIndentWidth: 4</div><div class="line">ObjCSpaceAfterProperty: true</div><div class="line">ObjCSpaceBeforeProtocolList: true</div><div class="line">PenaltyBreakBeforeFirstCallParameter: 10000</div><div class="line">PenaltyBreakComment: 300</div><div class="line">PenaltyBreakString: 1000</div><div class="line">PenaltyBreakFirstLessLess: 120</div><div class="line">PenaltyExcessCharacter: 1000000</div><div class="line">PenaltyReturnTypeOnItsOwnLine: 200</div><div class="line">PointerAlignment: Right</div><div class="line">SpacesBeforeTrailingComments: 1</div><div class="line">Cpp11BracedListStyle: true</div><div class="line">Standard:        Auto</div><div class="line">IndentWidth:     4</div><div class="line">TabWidth:        8</div><div class="line">UseTab:          Never</div><div class="line">BreakBeforeBraces: Custom</div><div class="line">BraceWrapping: </div><div class="line">    AfterClass: true</div><div class="line">    AfterControlStatement: false</div><div class="line">    AfterEnum: false</div><div class="line">    AfterFunction: false</div><div class="line">    AfterNamespace: true</div><div class="line">    AfterObjCDeclaration: true</div><div class="line">    AfterStruct: false</div><div class="line">    AfterUnion: false</div><div class="line">    BeforeCatch: false</div><div class="line">    BeforeElse: false</div><div class="line">    IndentBraces: false</div><div class="line"></div><div class="line">SpacesInParentheses: false</div><div class="line">SpacesInSquareBrackets: false</div><div class="line">SpacesInAngles:  false</div><div class="line">SpaceInEmptyParentheses: false</div><div class="line">SpacesInCStyleCastParentheses: false</div><div class="line">SpaceAfterCStyleCast: false</div><div class="line">SpacesInContainerLiterals: true</div><div class="line">SpaceBeforeAssignmentOperators: true</div><div class="line"></div><div class="line">ContinuationIndentWidth: 4</div><div class="line">CommentPragmas:  &apos;^ IWYU pragma:&apos;</div><div class="line">ForEachMacros:   [ foreach, Q_FOREACH, BOOST_FOREACH ]</div><div class="line">SpaceBeforeParens: ControlStatements</div><div class="line">DisableFormat:   false</div></pre></td></tr></table></figure>
<p><a href="http://clang.llvm.org/docs/ClangFormatStyleOptions.html"><em>英文版 Clang-Format Style Options</em></a> 自己定制的话，看看这个吧！<br><a href="http://www.jianshu.com/p/542e535117eb"><em>ClangFormat语法1.0</em></a> 简书上有一个中文版的,好像不是特别完整,一般自己玩玩也是够了.</p>
<h3 id="六、How-to-use"><a href="#六、How-to-use" class="headerlink" title="六、How to use"></a>六、How to use</h3><ol>
<li>Xcode-Edit-ClangFormat-File选项</li>
<li>选择你想要格式化的代码，然后Edit-ClangFormat-确认File为勾选状态-Format Selected Text</li>
</ol>
<p>设置快捷键</p>
<p>系统偏好设置－键盘－快捷键－应用快捷键- +<br><img src="http://i2.buimg.com/567571/586f472600761b93.jpg" alt=""><br>我自己设置的是<code>option</code>＋<code>,</code> </p>
<h3 id="七、Ending"><a href="#七、Ending" class="headerlink" title="七、Ending"></a>七、Ending</h3><p>作为代码编写者，编写让自己舒服，让reviewer舒服的代码是我们的责任, 在编码过程中难免会出现时间紧任务重的情况，作为软件开发人员，耗费大量的精力去调整自己的代码格式是非常不值得的事情。况且在团队协同开发的时候如果自己编写的代码不符合团队规范，即使能够很好的完成工作，那也是不道德的事情。通过一个简单的工作一劳永逸的解决这个问题，又何乐而不为呢？</p>
<h3 id="八、The-next"><a href="#八、The-next" class="headerlink" title="八、The next"></a>八、The next</h3><p>最近在看《重构》这本是，虽然是java写的，希望自己能在学习之后能够更快速更科学的重构项目，重构代码。</p>
</article><section id="comments"><h2>Comments<div id="disqus_thread"><noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus</a>.</noscript></div></h2></section></main><script async>(function(h,g,l,k,j,i){j=h.createElement(g),i=h.getElementsByTagName(g)[0],
j.src = '//' + l + '.disqus.com/' + k + '.js', i.parentNode.insertBefore(j, i)})
(document,'script','your-disqus-shortname','embed');
</script><script async>var disqus_shortname = 'your-disqus-shortname';
(function () {
var s = document.createElement('script'); s.async = true;
s.type = 'text/javascript';
s.src = '//' + disqus_shortname + '.disqus.com/count.js';
(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(s);
}());
</script></body></html>